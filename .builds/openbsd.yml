image: openbsd/6.9
sources:
  - https://git.sr.ht/~willroe/darcs_build
packages:
  - ghc
  - cabal-install
environment:
  DARCS_VERSION: 2.16.5
tasks:
  - build: |
      curl https://hackage.haskell.org/package/darcs-$DARCS_VERSION/darcs-$DARCS_VERSION.tar.gz -o darcs-$DARCS_VERSION.tar.gz
      tar xvzf darcs-$DARCS_VERSION.tar.gz
      cd darcs-$DARCS_VERSION
      cabal v2-update
      cabal v2-build exe:darcs
      cp dist-newstyle/build/x86_64-openbsd/ghc-*/darcs-$DARCS_VERSION/build/darcs/darcs ../darcs
artifacts:
  - darcs
